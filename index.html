<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Velvet Runway — The Enriquez Family</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="orbital-grid" aria-hidden="true"></div>
  <header class="site-header">
    <div class="brand">
      <span class="brand-mark" aria-hidden="true"></span>
      <div>
        <p class="brand-eyebrow">Enriquez Family Field Notes</p>
        <h1>Velvet Runway</h1>
      </div>
    </div>
    <nav class="site-nav">
      <a href="#weather">METAR/TAF</a>
      <a href="#airports">Airports</a>
      <a href="#events">Events</a>
      <a href="#logbook">Logbook</a>
      <a href="#gallery">Gallery</a>
    </nav>
    <form class="newsletter-form" action="mailto:velvetrunwayfamily@gmail.com" method="post" enctype="text/plain">
      <label class="sr-only" for="newsletterEmail">Email address</label>
      <input id="newsletterEmail" name="email" type="email" placeholder="Email for the quarterly aviation roundup" required />
      <span class="newsletter-note">Quarterly newsletter with our family aviation highlights.</span>
      <input type="hidden" name="subject" value="Velvet Runway newsletter signup" />
      <input type="hidden" name="body" value="Please add me to the quarterly family aviation newsletter." />
      <button class="primary-cta" type="submit">Join Our Flight List</button>
    </form>
  </header>

  <main>
    <section id="weather" class="section weather">
      <div class="section-heading">
        <h3>Local METAR &amp; TAF</h3>
        <p>Simple, current reports for the airports you care about most.</p>
      </div>
      <div class="wx-single">
        <div class="wx-select">
          <label for="airportSelect">Choose airport</label>
          <select id="airportSelect">
            <option value="KPOC" selected>Brackett Field (KPOC)</option>
            <option value="KCCB">Cable Airport (KCCB)</option>
            <option value="KRAL">Riverside Municipal (KRAL)</option>
          </select>
        </div>
        <article class="wx-card">
          <div class="wx-header">
            <h4 id="wxName">Brackett Field</h4>
            <span class="wx-ident" id="wxIdent">KPOC</span>
          </div>
          <div class="wx-block" data-type="metar" data-status="loading">
            <div class="wx-block-header">
              <p class="wx-label">METAR</p>
              <div class="wx-meta">
                <span class="wx-age" id="wxMetarAge" aria-live="polite">Age: --</span>
                <span class="wx-flag" id="wxMetarFlag" aria-hidden="true">FLAG</span>
              </div>
            </div>
            <p class="wx-text" id="wxMetar">Loading latest METAR...</p>
          </div>
          <div class="wx-block" data-type="taf" data-status="loading">
            <div class="wx-block-header">
              <p class="wx-label">TAF</p>
              <div class="wx-meta">
                <span class="wx-age" id="wxTafAge" aria-live="polite">Age: --</span>
                <span class="wx-flag" id="wxTafFlag" aria-hidden="true">FLAG</span>
              </div>
            </div>
            <p class="wx-text" id="wxTaf">Loading latest TAF...</p>
          </div>
        </article>
      </div>
      <p class="fineprint" id="wxUpdated">Last updated: — • Source: NOAA Aviation Weather Center</p>
    </section>

    <section class="hero">
      <div class="hero-copy">
        <p class="eyebrow">Mid-century calm • Jet-age energy</p>
        <h2>Your family HQ for aviation adventures.</h2>
        <p class="lead">
          Track local airport events, log unforgettable flights, and collect your favorite
          mid-century moments in one warm, modern home on the web.
        </p>
        <div class="hero-actions">
          <button class="primary-cta">Add Next Event</button>
          <button class="ghost-cta">Share the Calendar</button>
        </div>
        <div class="hero-meta">
          <div>
            <p class="meta-label">Nearest Airfields</p>
            <p class="meta-value">Z99 • KSQL • KOAK</p>
          </div>
          <div>
            <p class="meta-label">This Month</p>
            <p class="meta-value">4 fly-ins • 2 museum nights</p>
          </div>
          <div>
            <p class="meta-label">Tracking Radius</p>
            <p class="meta-value">50 miles • Top 15 list</p>
          </div>
          <div>
            <p class="meta-label">Weather Watch</p>
            <p class="meta-value">KPOC • KCCB • KRAL</p>
          </div>
        </div>
      </div>
      <div class="hero-panel">
        <div class="panel-card">
          <p class="panel-title">Next On The Radar</p>
          <div class="event">
            <div>
              <p class="event-title">Golden Gate Aviation Night</p>
              <p class="event-meta">Friday • 6:30 PM • San Carlos Airport</p>
            </div>
            <span class="event-tag">Fly-in</span>
          </div>
          <div class="event">
            <div>
              <p class="event-title">Museum After Dark</p>
              <p class="event-meta">Saturday • 7:00 PM • Hiller Aviation</p>
            </div>
            <span class="event-tag">Exhibit</span>
          </div>
          <div class="event">
            <div>
              <p class="event-title">Runway Picnic</p>
              <p class="event-meta">Sunday • 12:00 PM • Oakland North Field</p>
            </div>
            <span class="event-tag">Family</span>
          </div>
        </div>
        <div class="panel-stamp">
          <p class="stamp-title">Jet Age Checklist</p>
          <ul>
            <li>Polaroid wall updated</li>
            <li>Flight log digitized</li>
            <li>Retro soundtrack queued</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="airports" class="section airports">
      <div class="section-heading">
        <h3>Top 15 Airports Within 50 Miles of 91767</h3>
        <p>Sorted by distance from the ZIP centroid.</p>
      </div>
      <div class="table-card">
        <table>
          <thead>
            <tr>
              <th>Airport</th>
              <th>City</th>
              <th>Ident</th>
              <th>Type</th>
              <th>Distance</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>Brackett Field</td><td>La Verne</td><td>KPOC</td><td>small airport</td><td>2.6 mi</td></tr>
            <tr><td>Upland-Cable Airport</td><td>Upland</td><td>KCCB</td><td>small airport</td><td>3.6 mi</td></tr>
            <tr><td>Ontario International Airport</td><td>Ontario</td><td>KONT</td><td>large airport</td><td>8.1 mi</td></tr>
            <tr><td>Chino Airport</td><td>Chino</td><td>KCNO</td><td>small airport</td><td>9.4 mi</td></tr>
            <tr><td>Corona Municipal Airport</td><td>Corona</td><td>KAJO</td><td>small airport</td><td>14.9 mi</td></tr>
            <tr><td>San Gabriel Valley Airport</td><td>El Monte</td><td>KEMT</td><td>small airport</td><td>17.0 mi</td></tr>
            <tr><td>Riverside Municipal Airport</td><td>Riverside</td><td>KRAL</td><td>medium airport</td><td>19.1 mi</td></tr>
            <tr><td>Flabob Airport</td><td>Riverside</td><td>KRIR</td><td>small airport</td><td>19.8 mi</td></tr>
            <tr><td>Fullerton Municipal Airport</td><td>Fullerton</td><td>KFUL</td><td>small airport</td><td>20.0 mi</td></tr>
            <tr><td>Andy Jackson Airpark</td><td>San Bernadino</td><td>US-12870</td><td>small airport</td><td>25.0 mi</td></tr>
            <tr><td>Los Alamitos Army Air Field</td><td>Los Alamitos</td><td>KSLI</td><td>medium airport</td><td>27.0 mi</td></tr>
            <tr><td>Great Park Balloon Ride</td><td>Irvine</td><td>US-7111</td><td>balloonport</td><td>28.2 mi</td></tr>
            <tr><td>Crystal Airport</td><td>Llano</td><td>46CN</td><td>small airport</td><td>28.3 mi</td></tr>
            <tr><td>San Bernardino International Airport</td><td>San Bernardino</td><td>KSBD</td><td>large airport</td><td>28.7 mi</td></tr>
            <tr><td>John Wayne Orange County International Airport</td><td>Santa Ana</td><td>KSNA</td><td>large airport</td><td>29.1 mi</td></tr>
          </tbody>
        </table>
      </div>
      <p class="fineprint">Top 15 by distance. Based on OurAirports data. Distances are approximate from ZIP 91767 centroid.</p>
    </section>

    <section id="events" class="section">
      <div class="section-heading">
        <h3>Upcoming Aviation Events (Next 2 Weeks)</h3>
        <p>Curated within ~50 miles of 91767. Links go to official event pages.</p>
      </div>
      <div class="card-grid">
        <article class="event-card">
          <h4>Hangar Talk &amp; Flight: Republic P-47G Thunderbolt</h4>
          <p class="card-meta">Saturday, Feb 7, 2026 • 10:30 AM • Planes of Fame Air Museum (Chino)</p>
          <p class="card-body">Hangar talk plus a live aircraft flight and presentation.</p>
          <a class="text-cta" href="https://planesoffame.org/events-calendar2/Hangar-Talk-1" target="_blank" rel="noopener">View Event</a>
        </article>
        <article class="event-card">
          <h4>A Heart for Riverside (Fundraiser at March Field Air Museum)</h4>
          <p class="card-meta">Saturday, Feb 14, 2026 • 5:30 PM • March Field Air Museum (Riverside)</p>
          <p class="card-body">Fundraiser evening with dinner and dancing supporting Riverside youth projects.</p>
          <a class="text-cta" href="https://www.eventbrite.com/e/a-heart-for-riverside-tickets-1971882351194" target="_blank" rel="noopener">View Event</a>
        </article>
      </div>
      <p class="fineprint">If you want more listings, I can expand the radius or include museum calendars beyond this two‑week window.</p>
    </section>

    <section id="logbook" class="section split">
      <div>
        <h3>Family Flight Logbook</h3>
        <p>
          Capture tail numbers, routes, notes, and favorite moments. Each entry becomes a
          keepsake you can sort by destination, aircraft, or season.
        </p>
        <div class="logbook">
          <div>
            <p class="log-label">Last Flight</p>
            <p class="log-value">Bay Tour • Cessna 172 • 44 minutes</p>
          </div>
          <div>
            <p class="log-label">Favorite View</p>
            <p class="log-value">Golden Gate pass at sunset</p>
          </div>
          <div>
            <p class="log-label">Next Adventure</p>
            <p class="log-value">Santa Barbara coastal hop</p>
          </div>
        </div>
      </div>
      <div class="logbook-panel">
        <p class="panel-title">Add A Flight Memory</p>
        <form>
          <label>
            Flight name
            <input type="text" placeholder="Evening Loop Over the Bay" />
          </label>
          <label>
            Date & location
            <input type="text" placeholder="Feb 18 • Palo Alto" />
          </label>
          <label>
            Memory
            <textarea rows="4" placeholder="Favorite moment from the flight..."></textarea>
          </label>
          <button class="primary-cta" type="button">Save Entry</button>
        </form>
      </div>
    </section>

    <section id="gallery" class="section">
      <div class="section-heading">
        <h3>Photo Hangar</h3>
        <p>Mix family portraits with vintage travel posters for a jet-age moodboard.</p>
      </div>
      <div class="gallery-grid">
        <!-- GALLERY:START -->
        <figure class="gallery-tile">
          <img src="images/warbird-field-selfie.jpg" alt="Warbird Field Selfie." />
          <figcaption>Warbird Field Selfie</figcaption>
        </figure>
        <figure class="gallery-tile">
          <img src="images/family-plane-portrait.jpg" alt="Family Plane Portrait." />
          <figcaption>Family Plane Portrait</figcaption>
        </figure>
        <figure class="gallery-tile">
          <img src="images/runway-plane-portrait.jpg" alt="Runway Plane Portrait." />
          <figcaption>Runway Plane Portrait</figcaption>
        </figure>
        <figure class="gallery-tile">
          <img src="images/cockpit-kid-adventure.jpg" alt="Cockpit Kid Adventure." />
          <figcaption>Cockpit Kid Adventure</figcaption>
        </figure>
        <figure class="gallery-tile">
          <img src="images/museum-jet-moment.jpg" alt="Museum Jet Moment." />
          <figcaption>Museum Jet Moment</figcaption>
        </figure>
        <figure class="gallery-tile">
          <img src="images/helicopter-family-visit.jpg" alt="Helicopter Family Visit." />
          <figcaption>Helicopter Family Visit</figcaption>
        </figure>
        <!-- GALLERY:END -->
      </div>
    </section>

  </main>

  <footer class="site-footer">
    <div>
      <p class="footer-title">Velvet Runway</p>
      <p class="footer-sub">A family website inspired by the jet age.</p>
    </div>
    <div class="footer-actions">
      <button class="ghost-cta">Print the Logbook</button>
      <button class="primary-cta">Send an Update</button>
    </div>
  </footer>
  <script>
    const airportData = {
      KPOC: { name: "Brackett Field" },
      KCCB: { name: "Cable Airport" },
      KRAL: { name: "Riverside Municipal" }
    };

    const select = document.getElementById("airportSelect");
    const nameEl = document.getElementById("wxName");
    const identEl = document.getElementById("wxIdent");
    const metarEl = document.getElementById("wxMetar");
    const tafEl = document.getElementById("wxTaf");
    const metarAgeEl = document.getElementById("wxMetarAge");
    const tafAgeEl = document.getElementById("wxTafAge");
    const metarBlock = metarEl?.closest(".wx-block");
    const tafBlock = tafEl?.closest(".wx-block");
    const updatedEl = document.getElementById("wxUpdated");
    let weatherData = null;

    const STALE_THRESHOLDS = {
      metar: 60 * 60 * 1000,
      taf: 60 * 60 * 1000
    };

    function formatTime(value) {
      if (!value) return "";
      const date = new Date(value);
      if (Number.isNaN(date.getTime())) return "";
      return date.toLocaleString();
    }

    function parseTime(value) {
      if (!value) return null;
      if (typeof value === "number" && Number.isFinite(value)) {
        return value > 1e12 ? value : value * 1000;
      }
      if (typeof value === "string") {
        const parsed = Date.parse(value);
        if (!Number.isNaN(parsed)) return parsed;
        const numeric = Number(value);
        if (Number.isFinite(numeric)) return numeric > 1e12 ? numeric : numeric * 1000;
      }
      return null;
    }

    function formatAge(ms) {
      if (!Number.isFinite(ms) || ms < 0) return "--";
      const totalMinutes = Math.floor(ms / 60000);
      if (totalMinutes < 1) return "<1m";
      const hours = Math.floor(totalMinutes / 60);
      const minutes = totalMinutes % 60;
      if (hours > 0) return minutes ? `${hours}h ${minutes}m` : `${hours}h`;
      return `${minutes}m`;
    }

    function setStatus(block, status) {
      if (block) block.dataset.status = status;
    }

    function updateBlock(type, block, ageEl, timeMs) {
      if (!block) return;
      if (Number.isFinite(timeMs)) {
        block.dataset.timeMs = String(timeMs);
      } else {
        delete block.dataset.timeMs;
      }
      const ageMs = Number.isFinite(timeMs) ? Date.now() - timeMs : null;
      if (ageEl) ageEl.textContent = `Age: ${formatAge(ageMs)}`;
      const threshold = STALE_THRESHOLDS[type] || STALE_THRESHOLDS.metar;
      if (!Number.isFinite(ageMs)) {
        setStatus(block, "stale");
      } else if (ageMs > threshold) {
        setStatus(block, "stale");
      } else {
        setStatus(block, "ok");
      }
    }

    function updateAges() {
      const now = Date.now();
      const blocks = [
        { type: "metar", block: metarBlock, ageEl: metarAgeEl },
        { type: "taf", block: tafBlock, ageEl: tafAgeEl }
      ];
      blocks.forEach(({ type, block, ageEl }) => {
        if (!block) return;
        const timeMs = Number(block.dataset.timeMs);
        if (!Number.isFinite(timeMs)) return;
        const ageMs = now - timeMs;
        if (ageEl) ageEl.textContent = `Age: ${formatAge(ageMs)}`;
        if (block.dataset.status === "error") return;
        const threshold = STALE_THRESHOLDS[type] || STALE_THRESHOLDS.metar;
        setStatus(block, ageMs > threshold ? "stale" : "ok");
      });
    }

    function renderWeather(code) {
      const fallback = airportData[code] || { name: code };
      nameEl.textContent = fallback.name;
      identEl.textContent = code;

      if (!weatherData || !weatherData.airports || !weatherData.airports[code]) {
        metarEl.textContent = "Unable to load METAR.";
        tafEl.textContent = "Unable to load TAF.";
        setStatus(metarBlock, "error");
        setStatus(tafBlock, "error");
        return;
      }

      const wx = weatherData.airports[code];
      const metarTimeMs = parseTime(wx.metarTime);
      const tafTimeMs = parseTime(wx.tafTime);
      const metarTime = formatTime(wx.metarTime);
      const tafTime = formatTime(wx.tafTime);

      metarEl.textContent = wx.metar
        ? `${wx.metar}${metarTime ? ` (${metarTime})` : ""}`
        : "No METAR available.";
      tafEl.textContent = wx.taf
        ? `${wx.taf}${tafTime ? ` (${tafTime})` : ""}`
        : "No TAF available.";
      updateBlock("metar", metarBlock, metarAgeEl, metarTimeMs);
      updateBlock("taf", tafBlock, tafAgeEl, tafTimeMs);
    }

    async function loadWeather() {
      try {
        const response = await fetch("data/aviation.json", { cache: "no-store" });
        if (!response.ok) throw new Error("Weather data missing");
        weatherData = await response.json();
        if (weatherData.updated) {
          updatedEl.textContent = `Last updated: ${formatTime(weatherData.updated)} • Source: NOAA Aviation Weather Center`;
        }
        renderWeather(select.value);
      } catch (err) {
        updatedEl.textContent = "Last updated: unavailable • Source: NOAA Aviation Weather Center";
        setStatus(metarBlock, "error");
        setStatus(tafBlock, "error");
        renderWeather(select.value);
      }
    }

    select.addEventListener("change", () => renderWeather(select.value));
    loadWeather();
    setInterval(updateAges, 15000);
  </script>
</body>
</html>
